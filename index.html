<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vendor Onboarding Form</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    label { font-weight: bold; display: block; margin-top: 15px; }
    input, select, textarea { width: 100%; padding: 6px; margin-top: 5px; }
    .checkbox-group, .multiple-choice { margin-top: 5px; }
    .checkbox-group label, .multiple-choice label {
      font-weight: normal; display: inline-flex; align-items: center; margin-right: 20px; white-space: nowrap;
    }
    .checkbox-group label input, .multiple-choice label input {
      margin-right: 5px;
      order: -1;
    }
    .attachments input { margin-top: 10px; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 16px; }

    /* Tooltip styles */
  .tooltip {
  position: relative;
  display: inline-block;
  vertical-align: middle;
  margin-left: 6px;
}

.tooltip .tooltip-icon {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  width: 14px;
  height: 14px;
  background-color: #d3d3d3;
  color: black;
  border-radius: 50%;
  font-size: 12px;
  font-weight: bold;
  cursor: pointer;
  line-height: 1;
  transition: background-color 0.3s;
}

.tooltip .tooltip-icon:hover {
  background-color: #b0b0b0;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 180px;
  background-color: #333;
  color: #fff;
  text-align: left;
  padding: 6px;
  border-radius: 5px;
  position: absolute;
  z-index: 1;
  top: 50%;
  left: 130%;
  transform: translateY(-50%);
  opacity: 0;
  transition: opacity 0.3s;
  font-size: 13px;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}
  </style>
</head>
<body>

<header style="display: flex; align-items: center; margin-bottom: 20px; background-color: black; padding: 10px 20px; color: white;">
  <img src="https://www.dentsu.com/assets/images/main-logo-alt.png" alt="Dentsu Logo" style="height: 25px; margin-right: 15px;" />
  <h2 style="margin: 0; color: white; font-size: 45px;">NEW VENDOR FORM</h2>
</header>
{% with messages = get_flashed_messages(with_categories=true) %}  {% if messages %}    {% for category, message in messages %}      <div id="flash-message" class="flash {{ category }}" style="        padding: 10px;        margin: 10px 0;        background-color: {% if category == 'success' %}#d4edda{% else %}#f8d7da{% endif %};        color: {% if category == 'success' %}#155724{% else %}#721c24{% endif %};        border: 1px solid {% if category == 'success' %}#c3e6cb{% else %}#f5c6cb{% endif %};        border-radius: 4px;      ">        {{ message }}      </div>    {% endfor %}  {% endif %}{% endwith %}
<form action="/itvendor/submit" method="POST" enctype="multipart/form-data">

  <fieldset style="border: 2px solid #ccc; padding: 15px 30px 15px 15px; margin-bottom: 20px;">
  <legend style="font-weight: bold; font-size: 18px;">1. Requester Information</legend>
  <!-- Request made by -->
 <label for="request_by" style="display: flex; align-items: center; gap: 8px;">
  Request made By:<span style="color: red;">*</span>
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">First and last name of the person who fills in the form</span>
  </span>
</label>
<input type="text" id="request_by" name="request_by" />

  <!-- Company: -->
  <label>Company:<span style="color: red;">*</span></label>
  <div id="company_section" class="checkbox-group">
    <label><input type="checkbox" name="company" value="DENTSU ITALIA SPA SB" /> DENTSU ITALIA SPA SB</label>
    <label><input type="checkbox" name="company" value="CARAT ITALIA SPA SB" /> CARAT ITALIA SPA SB</label>
    <label><input type="checkbox" name="company" value="IPROSPECT ITALIA SPA SB" /> IPROSPECT ITALIA SPA SB</label>
    <label><input type="checkbox" name="company" value="DENTSU DIGITAL SRL" /> DENTSU DIGITAL SRL</label>
    <label><input type="checkbox" name="company" value="DENTSU CREATIVE SRL SB" /> DENTSU CREATIVE SRL SB</label>
    <label><input type="checkbox" name="company" value="DENTSU TECH & SERVICES SRL" /> DENTSU TECH&SERVICES SRL</label>
    <label><input type="checkbox" name="company" value="DENTSU X SRL SB" /> DENTSU X SRL SB</label>
    <label><input type="checkbox" name="company" value="MERKLE ITALIA SRL" /> MERKLE ITALIA SRL</label>
    <label><input type="checkbox" name="company" value="MMA TECHNOLOGIES LTD" /> MMA TECHNOLOGIES LTD</label>
  </div>
  </fieldset>

  <fieldset style="border: 2px solid #ccc; padding: 15px 30px 15px 15px; margin-bottom: 20px;">
  <legend style="font-weight: bold; font-size: 18px;">2. Supplier Information</legend>

    <!-- Supplier Legal Personality -->
<label>
  Supplier Legal Personality:<span style="color: red;">*</span>
  <!-- Tooltip Icon -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">
      Select "Natural Person" (Persona Fisica) for individuals or "Legal Person" (Società o Ditta) for registered entities like companies or firms.
    </span>
  </span>
</label>
<select name="supplier_legal_personality" id="supplier_legal_personality" onchange="toggleSupplierFields()">
  <option value="">--Select--</option>
  <option value="Natural Person">Natural Person</option>
  <option value="Legal Person">Legal Person</option>
</select>


<!-- vendor created by Dentsu -->
<label>
  Vendor created by dentsu:<span style="color: red;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">
      Campo ad uso esclusivo da parte del personale Dentsu / Exclusive use of Dentsu staff
    </span>
  </span>
</label>

<select name="vendor_created_by_dentsu" id="vendor_created_by_dentsu" >
  <option value="">--Select--</option>
  <option value="Yes">Yes</option>
  <option value="No">No</option>
</select>


<div id="group_wrapper" style="display: block;">
  <!-- Group(D365) -->
  <label>
    Group (D365):<span style="color: red;">*</span>

    <!-- Tooltip Icon -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">
        <strong>MEDIA</strong>: se siete fornitori concessionari spazi pubblicitari<br>
        <strong>NONMEDIA</strong>: se siete fornitori di servizi collegati al business ma non siete concessionari o rivenditori di spazi pubblicitari<br>
        <strong>HOUSE</strong>: se siete fornitori di servizi non direttamente collegati al business e ai servizi forniti ai nostri clienti<br>
        <strong>INTCO</strong>: se siete fornitori intercompany<br>
        <strong>TAXSS</strong>: se siete fondi previdenziali
      </span>
    </span>
  </label>

  <select name="group_d365" id="group_d365" >
    <option value="">--Select--</option>
    <option value="MEDIA">MEDIA</option>
    <option value="NONMEDIA">NONMEDIA</option>
    <option value="HOUSE">HOUSE</option>
    <option value="INTCO">INTCO</option>
    <option value="TAXSS">TAXSS</option>
  </select>
</div>

    <!-- Influencer -->
    <label>Influencer (D365) promoter:<span style="color: red;">*</span>
  <select name="influencer_d365" id = "influencer_d365">
    <option value="">--Select--</option>
    <option value="Nessuno / None">Nessuno / None</option>
    <option value="Influencer">Influencer</option>
  </select>

    <!-- vendor website -->
    <div id="vendor_website_section" style="display: none;">
  <label for="vendor_website">Vendor Website:<span id="website_required_star" style="color: red; display: none;">*</span></label>
  <input type="url" id="vendor_website" name="vendor_website">
</div>

    <!-- inactive bpc entity -->
     <div id="inactive_bpc_entity_section" style="display: none;">
    <label for="inactive_bpc_entity">Inactive BPC entity (email):</label>
  <input type="email" id="inactive_bpc_entity" name="inactive_bpc_entity" />
</div>

      <!-- Media Vehicle Section (conditional) -->
  <div id="media_vehicle_section" style="display: none;">
    <label>Media Vehicle (indicate the name of the vehicle):<span style="color: red;">*</span></label>
    <div id = "media_vehicle" class="checkbox-group">
      <label><input type="checkbox" name="media_vehicle" value="INTERNET" /> INTERNET</label>
      <label><input type="checkbox" name="media_vehicle" value="STAMPA" /> STAMPA</label>
      <label><input type="checkbox" name="media_vehicle" value="STAMPA TV" /> STAMPA TV</label>
      <label><input type="checkbox" name="media_vehicle" value="TV OOH" /> TV OOH</label>
      <label><input type="checkbox" name="media_vehicle" value="OOH MEZZI DIVERSI" /> OOH MEZZI DIVERSI</label>
      <label><input type="checkbox" name="media_vehicle" value="MEZZI DIVERSI DIGITAL" /> MEZZI DIVERSI DIGITAL</label>
      <label><input type="checkbox" name="media_vehicle" value="DIGITAL RADIO" /> DIGITAL RADIO</label>
      <label><input type="checkbox" name="media_vehicle" value="RADIO" /> RADIO</label>
    </div>
  </div>

    <!-- Natural Person Fields -->
  <div id="natural_person_fields" style="display: none;">

    <!-- first name -->
    <label for="first_name">First Name:<span style="color: red;">*</span></label>
    <input type="text" id="first_name" name="first_name" />

    <!-- last name -->
    <label for="last_name">Last Name:<span style="color: red;">*</span></label>
    <input type="text" id="last_name" name="last_name" />

    <!-- birth place -->
    <label for="birth_place">Birth Place:<span style="color: red;">*</span></label>
    <input type="text" id="birth_place" name="birth_place" />

   <!-- birth county -->
<label>
  Birth County:<span style="color: red;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Provincia di nascita</span>
  </span>
</label>

<select name="birth_county" id="birth_county">
  <option value="">--Select--</option>
  <option value="AG">AG - Agrigento</option>
  <option value="AL">AL - Alessandria</option>
  <option value="AN">AN - Ancona</option>
  <option value="AO">AO - Valle d'Aosta</option>
  <option value="AP">AP - Ascoli Piceno</option>
  <option value="AQ">AQ - L'Aquila</option>
  <option value="AR">AR - Arezzo</option>
  <option value="AT">AT - Asti</option>
  <option value="AV">AV - Avellino</option>
  <option value="BA">BA - Bari</option>
  <option value="BG">BG - Bergamo</option>
  <option value="BI">BI - Biella</option>
  <option value="BL">BL - Belluno</option>
  <option value="BN">BN - Benevento</option>
  <option value="BO">BO - Bologna</option>
  <option value="BR">BR - Brindisi</option>
  <option value="BS">BS - Brescia</option>
  <option value="BT">BT - Barletta-Andria-Trani</option>
  <option value="BZ">BZ - Bolzano</option>
  <option value="CA">CA - Cagliari</option>
  <option value="CB">CB - Campobasso</option>
  <option value="CE">CE - Caserta</option>
  <option value="CH">CH - Chieti</option>
  <option value="CL">CL - Caltanissetta</option>
  <option value="CN">CN - Cuneo</option>
  <option value="CO">CO - Como</option>
  <option value="CR">CR - Cremona</option>
  <option value="CS">CS - Cosenza</option>
  <option value="CT">CT - Catania</option>
  <option value="CZ">CZ - Catanzaro</option>
  <option value="EE">EE - Stato Estero</option>
  <option value="EN">EN - Enna</option>
  <option value="FC">FC - Forlì-Cesena</option>
  <option value="FE">FE - Ferrara</option>
  <option value="FG">FG - Foggia</option>
  <option value="FI">FI - Firenze</option>
  <option value="FM">FM - Fermo</option>
  <option value="FR">FR - Frosinone</option>
  <option value="GE">GE - Genova</option>
  <option value="GO">GO - Gorizia</option>
  <option value="GR">GR - Grosseto</option>
  <option value="IM">IM - Imperia</option>
  <option value="IS">IS - Isernia</option>
  <option value="KR">KR - Crotone</option>
  <option value="LC">LC - Lecco</option>
  <option value="LE">LE - Lecce</option>
  <option value="LI">LI - Livorno</option>
  <option value="LO">LO - Lodi</option>
  <option value="LT">LT - Latina</option>
  <option value="LU">LU - Lucca</option>
  <option value="MB">MB - Monza e Brianza</option>
  <option value="MC">MC - Macerata</option>
  <option value="ME">ME - Messina</option>
  <option value="MI">MI - Milano</option>
  <option value="MN">MN - Mantova</option>
  <option value="MO">MO - Modena</option>
  <option value="MS">MS - Massa-Carrara</option>
  <option value="MT">MT - Matera</option>
  <option value="NA">NA - Napoli</option>
  <option value="NO">NO - Novara</option>
  <option value="NU">NU - Nuoro</option>
  <option value="OR">OR - Oristano</option>
  <option value="PA">PA - Palermo</option>
  <option value="PC">PC - Piacenza</option>
  <option value="PD">PD - Padova</option>
  <option value="PE">PE - Pescara</option>
  <option value="PG">PG - Perugia</option>
  <option value="PI">PI - Pisa</option>
  <option value="PN">PN - Pordenone</option>
  <option value="PO">PO - Prato</option>
  <option value="PR">PR - Parma</option>
  <option value="PT">PT - Pistoia</option>
  <option value="PU">PU - Pesaro e Urbino</option>
  <option value="PV">PV - Pavia</option>
  <option value="PZ">PZ - Potenza</option>
  <option value="RA">RA - Ravenna</option>
  <option value="RC">RC - Reggio Calabria</option>
  <option value="RE">RE - Reggio Emilia</option>
  <option value="RG">RG - Ragusa</option>
  <option value="RI">RI - Rieti</option>
  <option value="RM">RM - Roma</option>
  <option value="RN">RN - Rimini</option>
  <option value="RO">RO - Rovigo</option>
  <option value="SA">SA - Salerno</option>
  <option value="SI">SI - Siena</option>
  <option value="SO">SO - Sondrio</option>
  <option value="SP">SP - La Spezia</option>
  <option value="SR">SR - Siracusa</option>
  <option value="SS">SS - Sassari</option>
  <option value="SU">SU - Sud Sardegna</option>
  <option value="SV">SV - Savona</option>
  <option value="TA">TA - Taranto</option>
  <option value="TE">TE - Teramo</option>
  <option value="TN">TN - Trento</option>
  <option value="TO">TO - Torino</option>
  <option value="TP">TP - Trapani</option>
  <option value="TR">TR - Terni</option>
  <option value="TS">TS - Trieste</option>
  <option value="TV">TV - Treviso</option>
  <option value="UD">UD - Udine</option>
  <option value="VA">VA - Varese</option>
  <option value="VB">VB - Verbano-Cusio-Ossola</option>
  <option value="VC">VC - Vercelli</option>
  <option value="VE">VE - Venezia</option>
  <option value="VI">VI - Vicenza</option>
  <option value="VR">VR - Verona</option>
  <option value="VT">VT - Viterbo</option>
  <option value="VV">VV - Vibo Valentia</option>
</select>


    <!-- birth date -->
    <label for="birth_date">Birth Date:<span style="color: red;">*</span></label>
    <input type="date" id="birth_date" name="birth_date" />

    <!-- gender -->
    <label>Gender:<span style="color: red;">*</span></label>
    <select name="gender" id="gender">
      <option value="">--Select--</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
    </select>
  </div>

    <div id="legal_person_fields" style="display: none;">
      <!-- supplier company name -->
    <label for="supplier_company_name">Supplier Company Name:<span style="color: red;">*</span></label>
  <input type="text" id="supplier_company_name" name="supplier_company_name" />
      
    </div>

   <!-- address -->
    <label for="address">Address:<span style="color: red;">*</span></label>
  <input type="text" id="address" name="address" />

    <!-- N -->
  <label for="n">N:<span style="color: red;">*</span></label>
  <input type="text" id="n" name="n" />

    <!-- postal code -->
  <label for="postal_code">Postal Code:<span style="color: red;">*</span></label>
  <input type="text" id="postal_code" name="postal_code" />

    <!-- country -->
<label>Country:<span style="color: red;">*</span></label>
<select name="country" id="country">
  <option value="">--Select--</option>
  <option value="AFG">AFG - Afghanistan</option>
  <option value="ALA">ALA - Åland Islands</option>
  <option value="ALB">ALB - Albania</option>
  <option value="DZA">DZA - Algeria</option>
  <option value="ASM">ASM - American Samoa</option>
  <option value="AND">AND - Andorra</option>
  <option value="AGO">AGO - Angola</option>
  <option value="AIA">AIA - Anguilla</option>
  <option value="ATA">ATA - Antarctica</option>
  <option value="ATG">ATG - Antigua and Barbuda</option>
  <option value="ARG">ARG - Argentina</option>
  <option value="ARM">ARM - Armenia</option>
  <option value="ABW">ABW - Aruba</option>
  <option value="AUS">AUS - Australia</option>
  <option value="AUT">AUT - Austria</option>
  <option value="AZE">AZE - Azerbaijan</option>
  <option value="BHS">BHS - Bahamas</option>
  <option value="BHR">BHR - Bahrain</option>
  <option value="BLM">BLM - Saint Barthélemy</option>
  <option value="BGD">BGD - Bangladesh</option>
  <option value="BRB">BRB - Barbados</option>
  <option value="BLR">BLR - Belarus</option>
  <option value="BEL">BEL - Belgium</option>
  <option value="BLZ">BLZ - Belize</option>
  <option value="BEN">BEN - Benin</option>
  <option value="BMU">BMU - Bermuda</option>
  <option value="BTN">BTN - Bhutan</option>
  <option value="BOL">BOL - Bolivia</option>
  <option value="BIH">BIH - Bosnia and Herzegovina</option>
  <option value="BWA">BWA - Botswana</option>
  <option value="BVT">BVT - Bouvet Island</option>
  <option value="BRA">BRA - Brazil</option>
  <option value="IOT">IOT - British Indian Ocean Territory</option>
  <option value="BRN">BRN - Brunei</option>
  <option value="BGR">BGR - Bulgaria</option>
  <option value="BFA">BFA - Burkina Faso</option>
  <option value="BDI">BDI - Burundi</option>
  <option value="KHM">KHM - Cambodia</option>
  <option value="CMR">CMR - Cameroon</option>
  <option value="CAN">CAN - Canada</option>
  <option value="CPV">CPV - Cape Verde</option>
  <option value="CYM">CYM - Cayman Islands</option>
  <option value="CAF">CAF - Central African Republic</option>
  <option value="TCD">TCD - Chad</option>
  <option value="CHL">CHL - Chile</option>
  <option value="CHN">CHN - China</option>
  <option value="CXR">CXR - Christmas Island</option>
  <option value="CCK">CCK - Cocos (Keeling) Islands</option>
  <option value="COL">COL - Colombia</option>
  <option value="COM">COM - Comoros</option>
  <option value="COG">COG - Congo</option>
  <option value="COD">COD - Congo (DRC)</option>
  <option value="COK">COK - Cook Islands</option>
  <option value="CRI">CRI - Costa Rica</option>
  <option value="CIV">CIV - Côte d’Ivoire</option>
  <option value="HRV">HRV - Croatia</option>
  <option value="CUB">CUB - Cuba</option>
  <option value="CYP">CYP - Cyprus</option>
  <option value="CZE">CZE - Czech Republic</option>
  <option value="DNK">DNK - Denmark</option>
  <option value="DJI">DJI - Djibouti</option>
  <option value="DMA">DMA - Dominica</option>
  <option value="DOM">DOM - Dominican Republic</option>
  <option value="ECU">ECU - Ecuador</option>
  <option value="EGY">EGY - Egypt</option>
  <option value="SLV">SLV - El Salvador</option>
  <option value="GNQ">GNQ - Equatorial Guinea</option>
  <option value="ERI">ERI - Eritrea</option>
  <option value="EST">EST - Estonia</option>
  <option value="ETH">ETH - Ethiopia</option>
  <option value="FLK">FLK - Falkland Islands (Islas Malvinas)</option>
  <option value="FRO">FRO - Faroe Islands</option>
  <option value="FJI">FJI - Fiji</option>
  <option value="FIN">FIN - Finland</option>
  <option value="FRA">FRA - France</option>
  <option value="GUF">GUF - French Guiana</option>
  <option value="PYF">PYF - French Polynesia</option>
  <option value="ATF">ATF - French Southern and Antarctic Lands</option>
  <option value="GAB">GAB - Gabon</option>
  <option value="GMB">GMB - Gambia</option>
  <option value="GEO">GEO - Georgia</option>
  <option value="DEU">DEU - Germany</option>
  <option value="GHA">GHA - Ghana</option>
  <option value="GIB">GIB - Gibraltar</option>
  <option value="GRC">GRC - Greece</option>
  <option value="GRL">GRL - Greenland</option>
  <option value="GRD">GRD - Grenada</option>
  <option value="GLP">GLP - Guadeloupe</option>
  <option value="GUM">GUM - Guam</option>
  <option value="GTM">GTM - Guatemala</option>
  <option value="GGY">GGY - Guernsey</option>
  <option value="GIN">GIN - Guinea</option>
  <option value="GNB">GNB - Guinea-Bissau</option>
  <option value="GUY">GUY - Guyana</option>
  <option value="HTI">HTI - Haiti</option>
  <option value="HMD">HMD - Heard Island and McDonald Islands</option>
  <option value="HND">HND - Honduras</option>
  <option value="HKG">HKG - Hong Kong SAR</option>
  <option value="HUN">HUN - Hungary</option>
  <option value="ISL">ISL - Iceland</option>
  <option value="IND">IND - India</option>
  <option value="IDN">IDN - Indonesia</option>
  <option value="IRN">IRN - Iran</option>
  <option value="IRQ">IRQ - Iraq</option>
  <option value="IRL">IRL - Ireland</option>
  <option value="IMN">IMN - Isle of Man</option>
  <option value="ISR">ISR - Israel</option>
  <option value="ITA">ITA - Italy</option>
  <option value="JAM">JAM - Jamaica</option>
  <option value="JPN">JPN - Japan</option>
  <option value="JEY">JEY - Jersey</option>
  <option value="JOR">JOR - Jordan</option>
  <option value="KAZ">KAZ - Kazakhstan</option>
  <option value="KEN">KEN - Kenya</option>
  <option value="KIR">KIR - Kiribati</option>
  <option value="KOR">KOR - Korea</option>
  <option value="KWT">KWT - Kuwait</option>
  <option value="KGZ">KGZ - Kyrgyzstan</option>
  <option value="LAO">LAO - Laos</option>
  <option value="LVA">LVA - Latvia</option>
  <option value="LBN">LBN - Lebanon</option>
  <option value="LSO">LSO - Lesotho</option>
  <option value="LBR">LBR - Liberia</option>
  <option value="LBY">LBY - Libya</option>
  <option value="LIE">LIE - Liechtenstein</option>
  <option value="LTU">LTU - Lithuania</option>
  <option value="LUX">LUX - Luxembourg</option>
  <option value="MAC">MAC - Macao SAR</option>
  <option value="MAF">MAF - Saint Martin</option>
  <option value="MKD">MKD - Macedonia (Former Yugoslav Republic of)</option>
  <option value="MDG">MDG - Madagascar</option>
  <option value="MWI">MWI - Malawi</option>
    <option value="MYS">MYS - Malaysia</option>
  <option value="MDV">MDV - Maldives</option>
  <option value="MLI">MLI - Mali</option>
  <option value="MLT">MLT - Malta</option>
  <option value="MHL">MHL - Marshall Islands</option>
  <option value="MTQ">MTQ - Martinique</option>
  <option value="MRT">MRT - Mauritania</option>
  <option value="MUS">MUS - Mauritius</option>
  <option value="MYT">MYT - Mayotte</option>
  <option value="MEX">MEX - Mexico</option>
  <option value="FSM">FSM - Micronesia</option>
  <option value="MDA">MDA - Moldova</option>
  <option value="MCO">MCO - Monaco</option>
  <option value="MNG">MNG - Mongolia</option>
  <option value="MNE">MNE - Montenegro</option>
  <option value="MSR">MSR - Montserrat</option>
  <option value="MAR">MAR - Morocco</option>
  <option value="MOZ">MOZ - Mozambique</option>
  <option value="MMR">MMR - Myanmar</option>
  <option value="NAM">NAM - Namibia</option>
  <option value="NRU">NRU - Nauru</option>
  <option value="NPL">NPL - Nepal</option>
  <option value="NLD">NLD - Netherlands</option>
  <option value="ANT">ANT - Netherlands Antilles</option>
  <option value="NCL">NCL - New Caledonia</option>
  <option value="NZL">NZL - New Zealand</option>
  <option value="NIC">NIC - Nicaragua</option>
  <option value="NER">NER - Niger</option>
  <option value="NGA">NGA - Nigeria</option>
  <option value="NIU">NIU - Niue</option>
  <option value="NFK">NFK - Norfolk Island</option>
  <option value="PRK">PRK - North Korea</option>
  <option value="MNP">MNP - Northern Mariana Islands</option>
  <option value="NOR">NOR - Norway</option>
  <option value="OMN">OMN - Oman</option>
  <option value="PAK">PAK - Pakistan</option>
  <option value="PLW">PLW - Palau</option>
  <option value="PSE">PSE - Palestinian Authority</option>
  <option value="PAN">PAN - Panama</option>
  <option value="PNG">PNG - Papua New Guinea</option>
  <option value="PRY">PRY - Paraguay</option>
  <option value="PER">PER - Peru</option>
  <option value="PHL">PHL - Philippines</option>
  <option value="PCN">PCN - Pitcairn Islands</option>
  <option value="POL">POL - Poland</option>
  <option value="PRT">PRT - Portugal</option>
  <option value="PRI">PRI - Puerto Rico</option>
  <option value="QAT">QAT - Qatar</option>
  <option value="REU">REU - Reunion</option>
  <option value="ROU">ROU - Romania</option>
  <option value="RUS">RUS - Russia</option>
  <option value="RWA">RWA - Rwanda</option>
  <option value="SHN">SHN - Saint Helena Ascension and Tristan da Cunha</option>
  <option value="KNA">KNA - Saint Kitts and Nevis</option>
  <option value="LCA">LCA - Saint Lucia</option>
  <option value="SPM">SPM - Saint Pierre and Miquelon</option>
  <option value="VCT">VCT - Saint Vincent and the Grenadines</option>
  <option value="WSM">WSM - Samoa</option>
  <option value="SMR">SMR - San Marino</option>
  <option value="STP">STP - São Tomé and Príncipe</option>
  <option value="SAU">SAU - Saudi Arabia</option>
  <option value="SEN">SEN - Senegal</option>
  <option value="SRB">SRB - Serbia</option>
  <option value="SYC">SYC - Seychelles</option>
  <option value="SLE">SLE - Sierra Leone</option>
  <option value="SGP">SGP - Singapore</option>
  <option value="SVK">SVK - Slovakia</option>
  <option value="SVN">SVN - Slovenia</option>
  <option value="SLB">SLB - Solomon Islands</option>
  <option value="SOM">SOM - Somalia</option>
  <option value="ZAF">ZAF - South Africa</option>
  <option value="SGS">SGS - South Georgia and the South Sandwich Islands</option>
  <option value="ESP">ESP - Spain</option>
  <option value="LKA">LKA - Sri Lanka</option>
  <option value="SDN">SDN - Sudan</option>
  <option value="SUR">SUR - Suriname</option>
  <option value="SJM">SJM - Svalbard and Jan Mayen Island</option>
  <option value="SWZ">SWZ - Swaziland</option>
  <option value="SWE">SWE - Sweden</option>
  <option value="CHE">CHE - Switzerland</option>
  <option value="SYR">SYR - Syria</option>
  <option value="TWN">TWN - Taiwan</option>
  <option value="TJK">TJK - Tajikistan</option>
  <option value="TZA">TZA - Tanzania</option>
  <option value="THA">THA - Thailand</option>
  <option value="TLS">TLS - Timor-Leste</option>
  <option value="TGO">TGO - Togo</option>
  <option value="TKL">TKL - Tokelau</option>
  <option value="TON">TON - Tonga</option>
  <option value="TTO">TTO - Trinidad and Tobago</option>
  <option value="TUN">TUN - Tunisia</option>
  <option value="TUR">TUR - Turkey</option>
  <option value="TKM">TKM - Turkmenistan</option>
  <option value="TCA">TCA - Turks and Caicos Islands</option>
  <option value="TUV">TUV - Tuvalu</option>
  <option value="UMI">UMI - U.S. Minor Outlying Islands</option>
  <option value="UGA">UGA - Uganda</option>
  <option value="UKR">UKR - Ukraine</option>
  <option value="ARE">ARE - United Arab Emirates</option>
  <option value="GBR">GBR - United Kingdom</option>
  <option value="USA">USA - United States</option>
  <option value="URY">URY - Uruguay</option>
  <option value="UZB">UZB - Uzbekistan</option>
  <option value="VUT">VUT - Vanuatu</option>
  <option value="VAT">VAT - Vatican City</option>
  <option value="VEN">VEN - Venezuela</option>
  <option value="VNM">VNM - Vietnam</option>
  <option value="VGB">VGB - British Virgin Islands</option>
  <option value="VIR">VIR - Virgin Islands</option>
  <option value="WLF">WLF - Wallis and Futuna</option>
  <option value="YEM">YEM - Yemen</option>
  <option value="ZMB">ZMB - Zambia</option>
  <option value="ZWE">ZWE - Zimbabwe</option>
  <option value="BES">BES - Bonaire</option>
  <option value="CUW">CUW - Curaçao</option>
  <option value="XJA">XJA - Jan Mayen</option>
  <option value="XKS">XKS - Kosovo</option>
  <option value="XSE">XSE - Sint Eustatius</option>
  <option value="SXM">SXM - Sint Maarten</option>
  <option value="SSD">SSD - South Sudan</option>
</select>

       <!-- State and County -->
  <div id="state_and_county" style="display: none;">

      <label for="state">State<span style="color: red;">*</span></label>
<select name="state" id="state">
  <option value="">--Select--</option>
  <option value="ABB">ABB - ABRUZZO</option>
  <option value="BAS">BAS - BASILICATA</option>
  <option value="CAL">CAL - CALABRIA</option>
  <option value="CAM">CAM - CAMPANIA</option>
  <option value="EMI">EMI - EMILIA-ROMAGNA</option>
  <option value="FRI">FRI - FRIULI VENEZIA GIULIA</option>
  <option value="LAZ">LAZ - LAZIO</option>
  <option value="LIG">LIG - LIGURIA</option>
  <option value="LOM">LOM - LOMBARDIA</option>
  <option value="MAR">MAR - MARCHE</option>
  <option value="MOL">MOL - MOLISE</option>
  <option value="PIE">PIE - PIEMONTE</option>
  <option value="PUG">PUG - PUGLIA</option>
  <option value="SAR">SAR - SARDEGNA</option>
  <option value="SIC">SIC - SICILIA</option>
  <option value="TOS">TOS - TOSCANA</option>
  <option value="TRE">TRE - TRENTINO ALTO ADIGE</option>
  <option value="UMB">UMB - UMBRIA</option>
  <option value="VAL">VAL - VALLE D'AOSTA</option>
  <option value="VEN">VEN - VENETO</option>
</select>

    <label for="county">County<span style="color: red;">*</span></label>
<select name="county" id="county">
  <option value="">--Select--</option>
  <option value="AG">AG - Agrigento</option>
  <option value="AL">AL - Alessandria</option>
  <option value="AN">AN - Ancona</option>
  <option value="AO">AO - Valle d'Aosta</option>
  <option value="AP">AP - Ascoli Piceno</option>
  <option value="AQ">AQ - L'Aquila</option>
  <option value="AR">AR - Arezzo</option>
  <option value="AT">AT - Asti</option>
  <option value="AV">AV - Avellino</option>
  <option value="BA">BA - Bari</option>
  <option value="BG">BG - Bergamo</option>
  <option value="BI">BI - Biella</option>
  <option value="BL">BL - Belluno</option>
  <option value="BN">BN - Benevento</option>
  <option value="BO">BO - Bologna</option>
  <option value="BR">BR - Brindisi</option>
  <option value="BS">BS - Brescia</option>
  <option value="BT">BT - Barletta-Andria-Trani</option>
  <option value="BZ">BZ - Bolzano</option>
  <option value="CA">CA - Cagliari</option>
  <option value="CB">CB - Campobasso</option>
  <option value="CE">CE - Caserta</option>
  <option value="CH">CH - Chieti</option>
  <option value="CL">CL - Caltanissetta</option>
  <option value="CN">CN - Cuneo</option>
  <option value="CO">CO - Como</option>
  <option value="CR">CR - Cremona</option>
  <option value="CS">CS - Cosenza</option>
  <option value="CT">CT - Catania</option>
  <option value="CZ">CZ - Catanzaro</option>
  <option value="EN">EN - Enna</option>
  <option value="FC">FC - Forlì-Cesena</option>
  <option value="FE">FE - Ferrara</option>
  <option value="FG">FG - Foggia</option>
  <option value="FI">FI - Firenze</option>
  <option value="FM">FM - Fermo</option>
  <option value="FR">FR - Frosinone</option>
  <option value="GE">GE - Genova</option>
  <option value="GO">GO - Gorizia</option>
  <option value="GR">GR - Grosseto</option>
  <option value="IM">IM - Imperia</option>
  <option value="IS">IS - Isernia</option>
  <option value="KR">KR - Crotone</option>
  <option value="LC">LC - Lecco</option>
  <option value="LE">LE - Lecce</option>
  <option value="LI">LI - Livorno</option>
  <option value="LO">LO - Lodi</option>
  <option value="LT">LT - Latina</option>
  <option value="LU">LU - Lucca</option>
  <option value="MB">MB - Monza e Brianza</option>
  <option value="MC">MC - Macerata</option>
  <option value="ME">ME - Messina</option>
  <option value="MI">MI - Milano</option>
  <option value="MN">MN - Mantova</option>
  <option value="MO">MO - Modena</option>
  <option value="MS">MS - Massa-Carrara</option>
  <option value="MT">MT - Matera</option>
  <option value="NA">NA - Napoli</option>
  <option value="NO">NO - Novara</option>
  <option value="NU">NU - Nuoro</option>
  <option value="OR">OR - Oristano</option>
  <option value="PA">PA - Palermo</option>
  <option value="PC">PC - Piacenza</option>
  <option value="PD">PD - Padova</option>
  <option value="PE">PE - Pescara</option>
  <option value="PG">PG - Perugia</option>
  <option value="PI">PI - Pisa</option>
  <option value="PN">PN - Pordenone</option>
  <option value="PO">PO - Prato</option>
  <option value="PR">PR - Parma</option>
  <option value="PT">PT - Pistoia</option>
  <option value="PU">PU - Pesaro e Urbino</option>
  <option value="PV">PV - Pavia</option>
  <option value="PZ">PZ - Potenza</option>
  <option value="RA">RA - Ravenna</option>
  <option value="RC">RC - Reggio Calabria</option>
  <option value="RE">RE - Reggio Emilia</option>
  <option value="RG">RG - Ragusa</option>
  <option value="RI">RI - Rieti</option>
  <option value="RM">RM - Roma</option>
  <option value="RN">RN - Rimini</option>
  <option value="RO">RO - Rovigo</option>
  <option value="SA">SA - Salerno</option>
  <option value="SI">SI - Siena</option>
  <option value="SO">SO - Sondrio</option>
  <option value="SP">SP - La Spezia</option>
  <option value="SR">SR - Siracusa</option>
  <option value="SS">SS - Sassari</option>
  <option value="SU">SU - Sud Sardegna</option>
  <option value="SV">SV - Savona</option>
  <option value="TA">TA - Taranto</option>
  <option value="TE">TE - Teramo</option>
  <option value="TN">TN - Trento</option>
  <option value="TO">TO - Torino</option>
  <option value="TP">TP - Trapani</option>
  <option value="TR">TR - Terni</option>
  <option value="TS">TS - Trieste</option>
  <option value="TV">TV - Treviso</option>
  <option value="UD">UD - Udine</option>
  <option value="VA">VA - Varese</option>
  <option value="VB">VB - Verbano-Cusio-Ossola</option>
  <option value="VC">VC - Vercelli</option>
  <option value="VE">VE - Venezia</option>
  <option value="VI">VI - Vicenza</option>
  <option value="VR">VR - Verona</option>
  <option value="VT">VT - Viterbo</option>
  <option value="VV">VV - Vibo Valentia</option>
</select>
</div>

    <!-- city -->
<label for="city">City:<span style="color: red;">*</span></label>
<select id="city" name="city" required>
  <option value="">--Select a city--</option>
  <option value="Pescara">Pescara</option>
  <option value="L’Aquila">L’Aquila</option>
  <option value="Teramo">Teramo</option>
  <option value="Montesilvano">Montesilvano</option>
  <option value="Chieti">Chieti</option>
  <option value="San Severo">San Severo</option>
  <option value="Potenza">Potenza</option>
  <option value="Matera">Matera</option>
  <option value="Reggio Calabria">Reggio Calabria</option>
  <option value="Catanzaro">Catanzaro</option>
  <option value="Corigliano-Rossano">Corigliano-Rossano</option>
  <option value="Lamezia Terme">Lamezia Terme</option>
  <option value="Cosenza">Cosenza</option>
  <option value="Crotone">Crotone</option>
  <option value="Ancona">Ancona</option>
  <option value="Pesaro">Pesaro</option>
  <option value="Fano">Fano</option>
  <option value="Napoli">Napoli</option>
  <option value="Salerno">Salerno</option>
  <option value="Giugliano in Campania">Giugliano in Campania</option>
  <option value="Torre del Greco">Torre del Greco</option>
  <option value="Pozzuoli">Pozzuoli</option>
  <option value="Casoria">Casoria</option>
  <option value="Caserta">Caserta</option>
  <option value="Castellammare di Stabia">Castellammare di Stabia</option>
  <option value="Afragola">Afragola</option>
  <option value="Acerra">Acerra</option>
  <option value="Marano di Napoli">Marano di Napoli</option>
  <option value="Benevento">Benevento</option>
  <option value="Portici">Portici</option>
  <option value="Avellino">Avellino</option>
  <option value="Cava de' Tirreni">Cava de' Tirreni</option>
  <option value="Aversa">Aversa</option>
  <option value="Ercolano">Ercolano</option>
  <option value="Battipaglia">Battipaglia</option>
  <option value="Scafati">Scafati</option>
  <option value="Bologna">Bologna</option>
  <option value="Parma">Parma</option>
  <option value="Modena">Modena</option>
  <option value="Reggio Emilia">Reggio Emilia</option>
  <option value="Ravenna">Ravenna</option>
  <option value="Rimini">Rimini</option>
  <option value="Ferrara">Ferrara</option>
  <option value="Forlì">Forlì</option>
  <option value="Piacenza">Piacenza</option>
  <option value="Cesena">Cesena</option>
  <option value="Carpi">Carpi</option>
  <option value="Imola">Imola</option>
  <option value="Faenza">Faenza</option>
  <option value="Trieste">Trieste</option>
  <option value="Udine">Udine</option>
  <option value="Pordenone">Pordenone</option>
  <option value="Roma">Roma</option>
  <option value="Latina">Latina</option>
  <option value="Guidonia Montecelio">Guidonia Montecelio</option>
  <option value="Fiumicino">Fiumicino</option>
  <option value="Aprilia">Aprilia</option>
  <option value="Viterbo">Viterbo</option>
  <option value="Pomezia">Pomezia</option>
  <option value="Tivoli">Tivoli</option>
  <option value="Anzio">Anzio</option>
  <option value="Velletri">Velletri</option>
  <option value="Civitavecchia">Civitavecchia</option>
  <option value="Genova">Genova</option>
  <option value="La Spezia">La Spezia</option>
  <option value="Savona">Savona</option>
  <option value="Sanremo">Sanremo</option>
  <option value="Milano">Milano</option>
  <option value="Brescia">Brescia</option>
  <option value="Monza">Monza</option>
  <option value="Bergamo">Bergamo</option>
  <option value="Busto Arsizio">Busto Arsizio</option>
  <option value="Como">Como</option>
  <option value="Sesto San Giovanni">Sesto San Giovanni</option>
  <option value="Varese">Varese</option>
  <option value="Cinisello Balsamo">Cinisello Balsamo</option>
  <option value="Pavia">Pavia</option>
  <option value="Cremona">Cremona</option>
  <option value="Vigevano">Vigevano</option>
  <option value="Legnano">Legnano</option>
  <option value="Rho">Rho</option>
  <option value="Gallarate">Gallarate</option>
  <option value="Torino">Torino</option>
  <option value="Novara">Novara</option>
  <option value="Alessandria">Alessandria</option>
  <option value="Moncalieri">Moncalieri</option>
  <option value="Cuneo">Cuneo</option>
  <option value="Bari">Bari</option>
  <option value="Taranto">Taranto</option>
  <option value="Foggia">Foggia</option>
  <option value="Andria">Andria</option>
  <option value="Lecce">Lecce</option>
  <option value="Barletta">Barletta</option>
  <option value="Brindisi">Brindisi</option>
  <option value="Altamura">Altamura</option>
  <option value="Molfetta">Molfetta</option>
  <option value="Cerignola">Cerignola</option>
  <option value="Manfredonia">Manfredonia</option>
  <option value="Trani">Trani</option>
  <option value="Bisceglie">Bisceglie</option>
  <option value="Bitonto">Bitonto</option>
  <option value="Cagliari">Cagliari</option>
  <option value="Sassari">Sassari</option>
  <option value="Quartu Sant'Elena">Quartu Sant'Elena</option>
  <option value="Olbia">Olbia</option>
  <option value="Palermo">Palermo</option>
  <option value="Catania">Catania</option>
  <option value="Messina">Messina</option>
  <option value="Siracusa">Siracusa</option>
  <option value="Marsala">Marsala</option>
  <option value="Gela">Gela</option>
  <option value="Ragusa">Ragusa</option>
  <option value="Trapani">Trapani</option>
  <option value="Vittoria">Vittoria</option>
  <option value="Caltanissetta">Caltanissetta</option>
  <option value="Agrigento">Agrigento</option>
  <option value="Bagheria">Bagheria</option>
  <option value="Modica">Modica</option>
  <option value="Acireale">Acireale</option>
  <option value="Mazara del Vallo">Mazara del Vallo</option>
  <option value="Firenze">Firenze</option>
  <option value="Prato">Prato</option>
  <option value="Livorno">Livorno</option>
  <option value="Arezzo">Arezzo</option>
  <option value="Pisa">Pisa</option>
  <option value="Pistoia">Pistoia</option>
  <option value="Lucca">Lucca</option>
  <option value="Grosseto">Grosseto</option>
  <option value="Massa">Massa</option>
  <option value="Carrara">Carrara</option>
  <option value="Viareggio">Viareggio</option>
  <option value="Scandicci">Scandicci</option>
  <option value="Trento">Trento</option>
  <option value="Bolzano">Bolzano</option>
  <option value="Siena">Siena</option>
  <option value="Perugia">Perugia</option>
  <option value="Terni">Terni</option>
  <option value="Foligno">Foligno</option>
  <option value="Verona">Verona</option>
  <option value="Venezia">Venezia</option>
  <option value="Padova">Padova</option>
  <option value="Vicenza">Vicenza</option>
  <option value="Treviso">Treviso</option>
  <option value="Rovigo">Rovigo</option>
</select>


    <!-- telephone number -->
  <label for="telephone_number">Telephone Number:<span style="color: red;">*</span></label>
  <input type="text" id="telephone_number" name="telephone_number" />

  <!-- vat group -->
<label>
  VAT Group:<span style="color: red;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">
      Please select the type of VAT:<br>
      <strong>ITA</strong> – Italy<br>
      <strong>UE</strong> – European Union<br>
      <strong>XUE</strong> – Outside of European Union
    </span>
  </span>
</label>

<select name="vat_group" id="vat_group">
  <option value="">--Select--</option>
  <option value="FOR_ITA">FOR_ITA</option>
  <option value="FOR_UE">FOR_UE</option>
  <option value="FOR_XUE">FOR_XUE</option>
</select>


    <!-- PEC -->
<div id="pec_section" style="display: none;">
  <label for="pec">PEC:</label>
  <input type="email" id="pec" name="pec" />
  <span id="pec_error" style="color: red; font-size: 13px; display: none;">Please enter a valid email address</span>
</div>

<!-- dentsu contact email -->
<label for="dentsu_contact_email">
  dentsu Contact Email Address:<span style="color: red;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Email address of the dentsu contact person</span>
  </span>
</label>

<input type="email" id="dentsu_contact_email" name="dentsu_contact_email" />
<span id="dentsu_contact_email_error" style="color: red; font-size: 13px; display: none;">
  Please enter a valid email address
</span>


<!-- vendor email -->
<label for="vendor_email">Email del fornitore / Vendor’s email address:<span style="color: red;">*</span></label>
<input type="email" id="vendor_email" name="vendor_email" />
<span id="vendor_email_error" style="color: red; font-size: 13px; display: none;">Please enter a valid email address</span>


    <!-- professional -->
    <div id="professional_section" style="display: none;">
    <label>Professional:<span id="professional_required_star" style="color: red; display: none;">*</span></label>
  <select name="professional" id = "professional">
    <option value="">--Select--</option>
    <option value="Yes">Yes</option>
    <option value="No">No</option>
  </select>
    </div>

   <!-- withholding tax -->
<div id="witholding_tax_section" style="display: none;">
  <label for="withholding_tax">
    Withholding tax:<span id="witholding_tax_required_star" style="color: red; display: none;">*</span>

    <!-- Tooltip -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">Ritenuta d'acconto</span>
    </span>
  </label>

  <select name="withholding_tax" id="withholding_tax">
    <option value="">--Select--</option>
    <option value="E25 L.111/2011 Regime agevolato">E25 L.111/2011 Regime agevolato</option>
    <option value="E26 Legge 111/2011 Reg. agev. ENPALS 33%">E26 Legge 111/2011 Reg. agev. ENPALS 33%</option>
    <option value="P01 Compensi Professionisti 20%">P01 Compensi Professionisti 20%</option>
    <option value="P10 Compensi Lavoro autonomo 20%">P10 Compensi Lavoro autonomo 20%</option>
    <option value="P15 Compensi Prestazioni Occasionali 20%">P15 Compensi Prestazioni Occasionali 20%</option>
    <option value="P24 Diritti d'autore/marchi 75%">P24 Diritti d'autore/marchi 75%</option>
    <option value="P25 Diritti d'autore/marchi 60%">P25 Diritti d'autore/marchi 60%</option>
    <option value="P32 RA Provvigioni 23% su 50%">P32 RA Provvigioni 23% su 50%</option>
    <option value="P33 RA Provvigioni 23% su 20%">P33 RA Provvigioni 23% su 20%</option>
    <option value="P36 RA Provvigioni Proc.Affari 23% su 50%">P36 RA Provvigioni Proc.Affari 23% su 50%</option>
    <option value="P55 Lavoro autonomo 20% - ENPALS 33">P55 Lavoro autonomo 20% - ENPALS 33</option>
    <option value="00%">00%</option>
    <option value="P56 Lavoro autonomo 20% - ENPALS 35">P56 Lavoro autonomo 20% - ENPALS 35</option>
    <option value="70%">70%</option>
  </select>
</div>


  <!-- supplier vat number -->
<div id="supplier_vat_number_section" style="display: none;">
  <label for="supplier_vat_number">
    Supplier VAT Number:<span id="supplier_vat_number_required_star" style="color: red; display: none;">*</span>

    <!-- Tooltip -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">VAT number / Partita IVA</span>
    </span>
  </label>

  <input type="text" id="supplier_vat_number" name="supplier_vat_number" oninput="validateVATNumber()" />
  <span id="vat_error" style="color: red; font-size: 13px; display: none;">
    Please enter a valid 11-digit VAT number (only numbers).
  </span>
</div>



   <!-- supplier fiscal code -->
<div id="supplier_fiscal_code_section" style="display: none;">
  <label for="supplier_fiscal_code">
    Supplier Fiscal Code Number:<span id="supplier_fiscal_code_required_star" style="color: red; display: none;">*</span>

    <!-- Tooltip -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">Codice Fiscale</span>
    </span>
  </label>

  <input type="text" id="supplier_fiscal_code" name="supplier_fiscal_code">
</div>


    <!-- End-of-Supplier-Type Specific Fields -->
<div id="natural_person_fields_end" style="display: none;">
  <!-- attachment fiscal code -->
<label>
  Attachment fiscal code:<span id="attachment_fiscal_code_star" style="color: red; display: none;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Copy of fiscal code</span>
  </span>
 </label>
    <input type="file" name="attachment_fiscal_code" id="attachment_fiscal_code"  accept="application/pdf, image/*"  />

<!-- attachment identity card -->
 <label>
  Attachment Identity card:<span id="attachment_identity_card_star" style="color: red; display: none;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Copy of carta d’identità</span>
  </span>
 </label>
  <input type="file" id="attachment_identity_card" name="attachment_identity_card"  accept="application/pdf, image/*" />
</div>

      <!-- treatment type vat -->
<label for="treatment_type_vat">
  Treatment type VAT / Jurisprudence:

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Regime fiscale applicabile (ordinario, regimi minimi, ecc.)</span>
  </span>
</label>

<input type="text" id="treatment_type_vat" name="treatment_type_vat" />

<div id="legal_person_fields_end" style="display: none;">
  <!-- Business register number -->
  <label for="business_register_number">Number of inscription in the Business Register (CCIAA):</label>
  <input type="text" id="business_register_number" name="business_register_number" />

  <!-- attachment chambre -->
<div id="attachment_chambre_section" style="display: none;">
  <label for="attachment_chambre">
    Attachment Chambre of Commerce certification:
    <span id="attachment_chambre_required_star" style="color: red; display: none;">*</span>

    <!-- Tooltip -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">Scanned copy of Visura camerale</span>
    </span>
  </label>

  <input type="file" id="attachment_chambre" name="attachment_chambre"  accept="application/pdf, image/*" />
 </div>

 </div>
</fieldset>

    <fieldset style="border: 2px solid #ccc; padding: 15px 30px 15px 15px; margin-bottom: 20px;">
  <legend style="font-weight: bold; font-size: 18px;">3. Terms of Payment</legend>

    <!-- payment terms days -->
<label>
  Payment Term (Days):<span style="color: red;">*</span>

  <!-- Tooltip Icon -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">
      <strong>N + NR GIORNI</strong>: es. 30 giorni dalla data fattura<br>
      <strong>CM + NR GIORNI</strong>: es. 30 giorni dalla fine del mese della data fattura
    </span>
  </span>
</label>

<select name="payment_term_days" id = "payment_term_days">
  <option value="">--Select--</option>
  <option value="CM+30">CM+30 - CURRENT MONTH + 30 days</option>
  <option value="CM+45">CM+45 - CURRENT MONTH + 45 days</option>
  <option value="CM+60">CM+60 - CURRENT MONTH + 60 days</option>
  <option value="CM+75">CM+75 - CURRENT MONTH + 75 days</option>
  <option value="CM+90">CM+90 - CURRENT MONTH + 90 days</option>
  <option value="CM+120">CM+120 - CURRENT MONTH + 120 days</option>
  <option value="CM+150">CM+150 - CURRENT MONTH + 150 days</option>
  <option value="CM+180">CM+180 - CURRENT MONTH + 180 days</option>
  <option value="N00">N00 - Immediate payment</option>
  <option value="N15">N15 - 15 Days - Net</option>
  <option value="N30">N30 - 30 Days - Net</option>
  <option value="N60">N60 - 60 Days - Net</option>
  <option value="N75">N75 - 75 Days - Net</option>
  <option value="N90">N90 - 90 Days - Net</option>
  <option value="N120">N120 - 120 Days - Net</option>
  <option value="N150">N150 - 150 Days - Net</option>
</select>
      <!-- payment method -->
<label>
  Payment Method:<span style="color: red;">*</span>

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">Bonifico bancario SEPA / SEPA bank transfer</span>
  </span>
</label>

<select name="payment_method" id ="payment_method">
  <option value="">--Select--</option>
  <option value="EFT">EFT</option>
</select>


     <!-- payment term attachment -->
<label>
  Payment Terms Attachments:

  <!-- Tooltip -->
  <span class="tooltip">
    <span class="tooltip-icon">i</span>
    <span class="tooltiptext">
      Copia del contratto, ordine che riporti gli accordi di pagamento presi con le nostre società nel caso sia presente
    </span>
  </span>
</label>

<input type="file" name="payment_terms_attachments"  accept="application/pdf, image/*" />

   </fieldset>

  <fieldset style="border: 2px solid #ccc; padding: 15px 30px 15px 15px; margin-bottom: 20px;">
  <legend style="font-weight: bold; font-size: 18px;">4. Supplier Bank Account Information</legend>

    <!-- bank name -->
    <div id= "bank_name_section" style="display: none;">
     <label for="bank_name">Bank Name:<span id="bank_name_required_star" style="color: red; display: none;">*</span></label>
    <input type="text" id="bank_name" name="bank_name" />
  </div>

    <!-- bank address -->
    <div id= "bank_address_section" style="display: none;">
  <label for="bank_address">Bank Address:<span id="bank_address_required_star" style="color: red; display: none;">*</span></label>
  <input type="text" id="bank_address" name="bank_address" />
    </div>

    <!-- account holder -->
    <div id= "account_holder_section" style="display: none;">
  <label for="account_holder">Account Holder:<span id="account_holder_required_star" style="color: red; display: none;">*</span></label>
  <input type="text" id="account_holder" name="account_holder" />
  </div>

   <!-- account number -->
<div id="account_number_section" style="display: none;">
  <label for="account_number">
    Account Number:<span id="account_number_required_star" style="color: red; display: none;">*</span>
  </label>

  <input type="text" id="account_number" name="account_number" oninput="validateAccountNumber()"/>
  <span id="account_number_error" style="color: red; font-size: 13px; display: none;">
    Please enter a valid 12-digit account number.
  </span>
</div>


    <!-- currency -->
    <div id= "currency_section" style="display: none;">
  <label>Currency:<span id="currency_required_star" style="color: red; display: none;">*</span></label>
  <select name="currency" id="currency">
    <option value="">--Select--</option>
    <option value="AED">AED - USD</option>
  <option value="AFN">AFN - Afghani</option>
  <option value="ALL">ALL - Lek</option>
  <option value="AMD">AMD - Armenian Dram</option>
  <option value="ANG">ANG - Netherlands Antillian Guilder</option>
  <option value="AOA">AOA - Kwanza</option>
  <option value="ARS">ARS - Argentine Peso</option>
  <option value="AUD">AUD - Australian Dollar</option>
  <option value="AWG">AWG - Aruban Guilder</option>
  <option value="AZN">AZN - Azerbaijanian Manat</option>
  <option value="BAM">BAM - Convertible Marks</option>
  <option value="BBD">BBD - Barbados Dollar</option>
  <option value="BDT">BDT - Taka</option>
  <option value="BGN">BGN - Bulgarian Lev</option>
  <option value="BHD">BHD - Bahraini Dinar</option>
  <option value="BIF">BIF - Burundi Franc</option>
  <option value="BMD">BMD - Bermudian Dollar</option>
  <option value="BND">BND - Brunei Dollar</option>
  <option value="BOB">BOB - Boliviano</option>
  <option value="BOV">BOV - Mvdol</option>
  <option value="BRL">BRL - Brazilian Real</option>
  <option value="BSD">BSD - Bahamian Dollar</option>
  <option value="BTN">BTN - Ngultrum</option>
  <option value="BWP">BWP - Pula</option>
  <option value="BYR">BYR - Belarussian Ruble</option>
  <option value="BZD">BZD - Belize Dollar</option>
  <option value="CAD">CAD - Canadian Dollar</option>
  <option value="CDF">CDF - Franc Congolais</option>
  <option value="CHE">CHE - WIR Euro</option>
  <option value="CHF">CHF - Swiss Franc</option>
  <option value="CHW">CHW - WIR Franc</option>
  <option value="CLF">CLF - Unidades de fomento</option>
  <option value="CLP">CLP - Chilean Peso</option>
  <option value="CNY">CNY - Yuan Renminbi</option>
  <option value="COP">COP - Colombian Peso</option>
  <option value="COU">COU - Unidad de Valor Real</option>
  <option value="CRC">CRC - Costa Rican Colon</option>
  <option value="CUP">CUP - Cuban Peso</option>
  <option value="CVE">CVE - Cape Verde Escudo</option>
  <option value="CYP">CYP - Cyprus Pound</option>
  <option value="CZK">CZK - Czech Koruna</option>
  <option value="DJF">DJF - Djibouti Franc</option>
  <option value="DKK">DKK - Danish Krone</option>
  <option value="DOP">DOP - Dominican Peso</option>
  <option value="DZD">DZD - Algerian Dinar</option>
  <option value="EEK">EEK - Kroon</option>
  <option value="EGP">EGP - Egyptian Pound</option>
  <option value="ERN">ERN - Nakfa</option>
  <option value="ETB">ETB - Ethiopian Birr</option>
  <option value="EUR">EUR - Euro</option>
  <option value="FJD">FJD - Fiji Dollar</option>
  <option value="FKP">FKP - Falkland Islands (Islas Malvinas) Pound</option>
  <option value="GBP">GBP - Pound Sterling</option>
  <option value="GEL">GEL - Lari</option>
  <option value="GHS">GHS - Ghana Cedi</option>
  <option value="GIP">GIP - Gibraltar Pound</option>
  <option value="GMD">GMD - Dalasi</option>
  <option value="GNF">GNF - Guinea Franc</option>
  <option value="GTQ">GTQ - Quetzal</option>
  <option value="GWP">GWP - Guinea-Bissau Peso</option>
  <option value="GYD">GYD - Guyana Dollar</option>
  <option value="HKD">HKD - Hong Kong Dollar</option>
  <option value="HNL">HNL - Lempira</option>
  <option value="HRK">HRK - Croatian Kuna</option>
  <option value="HTG">HTG - Gourde</option>
  <option value="HUF">HUF - Forint</option>
  <option value="IDR">IDR - Rupiah</option>
  <option value="ILS">ILS - New Israeli Sheqel</option>
  <option value="INR">INR - Indian Rupee</option>
  <option value="IQD">IQD - Iraqi Dinar</option>
  <option value="IRR">IRR - Iranian Rial</option>
  <option value="ISK">ISK - Iceland Krona</option>
  <option value="JMD">JMD - Jamaican Dollar</option>
  <option value="JOD">JOD - Jordanian Dinar</option>
  <option value="JPY">JPY - Yen</option>
  <option value="KES">KES - Kenyan Shilling</option>
  <option value="KGS">KGS - Som</option>
  <option value="KHR">KHR - Riel</option>
  <option value="KMF">KMF - Comoro Franc</option>
  <option value="KPW">KPW - North Korean Won</option>
  <option value="KRW">KRW - Won</option>
  <option value="KWD">KWD - Kuwaiti Dinar</option>
  <option value="KYD">KYD - Cayman Islands Dollar</option>
  <option value="KZT">KZT - Tenge</option>
  <option value="LAK">LAK - Kip</option>
  <option value="LBP">LBP - Lebanese Pound</option>
  <option value="LKR">LKR - Sri Lanka Rupee</option>
  <option value="LRD">LRD - Liberian Dollar</option>
  <option value="LSL">LSL - Loti</option>
  <option value="LTL">LTL - Lithuanian Litas</option>
  <option value="LVL">LVL - Latvian Lats</option>
  <option value="LYD">LYD - Libyan Dinar</option>
  <option value="MAD">MAD - Moroccan Dirham</option>
  <option value="MDL">MDL - Moldovan Leu</option>
  <option value="MGA">MGA - Malagasy Ariary</option>
  <option value="MKD">MKD - Denar</option>
  <option value="MMK">MMK - Kyat</option>
  <option value="MNT">MNT - Tugrik</option>
  <option value="MOP">MOP - Pataca</option>
  <option value="MRO">MRO - Ouguiya</option>
  <option value="MTL">MTL - Maltese Lira</option>
  <option value="MUR">MUR - Mauritius Rupee</option>
  <option value="MVR">MVR - Rufiyaa</option>
  <option value="MWK">MWK - Kwacha</option>
  <option value="MXN">MXN - Mexican Peso</option>
  <option value="MXV">MXV - Mexican Unidad de Inversion (UID)</option>
  <option value="MYR">MYR - Malaysian Ringgit</option>
  <option value="MZN">MZN - Metical</option>
  <option value="NAD">NAD - Namibian Dollar</option>
  <option value="NGN">NGN - Naira</option>
  <option value="NIO">NIO - Cordoba Oro</option>
  <option value="NOK">NOK - Norwegian Krone</option>
  <option value="NPR">NPR - Nepalese Rupee</option>
  <option value="NZD">NZD - New Zealand Dollar</option>
  <option value="OMR">OMR - Rial Omani</option>
  <option value="PAB">PAB - Balboa</option>
  <option value="PEN">PEN - Nuevo Sol</option>
  <option value="PGK">PGK - Kina</option>
  <option value="PHP">PHP - Philippine Peso</option>
  <option value="PKR">PKR - Pakistan Rupee</option>
  <option value="PLN">PLN - Zloty</option>
  <option value="PYG">PYG - Guarani</option>
  <option value="QAR">QAR - Qatari Rial</option>
  <option value="ROL">ROL - Old Leu</option>
  <option value="RON">RON - New Leu</option>
  <option value="RSD">RSD - Serbian Dinar</option>
  <option value="RUB">RUB - Russian Ruble</option>
  <option value="RWF">RWF - Rwanda Franc</option>
  <option value="SAR">SAR - Saudi Riyal</option>
  <option value="SBD">SBD - Solomon Islands Dollar</option>
  <option value="SCR">SCR - Seychelles Rupee</option>
  <option value="SDG">SDG - Sudanese Dinar</option>
  <option value="SEK">SEK - Swedish Krona</option>
  <option value="SGD">SGD - Singapore Dollar</option>
  <option value="SHP">SHP - Saint Helena Pound</option>
  <option value="SKK">SKK - Slovak Koruna</option>
  <option value="SLL">SLL - Leone</option>
  <option value="SOS">SOS - Somali Shilling</option>
  <option value="SRD">SRD - Surinam Dollar</option>
  <option value="STD">STD - Dobra</option>
  <option value="SVC">SVC - El Salvador Colon</option>
  <option value="SYP">SYP - Syrian Pound</option>
  <option value="SZL">SZL - Lilangeni</option>
  <option value="THB">THB - Baht</option>
  <option value="TJS">TJS - Somoni</option>
  <option value="TMM">TMM - Manat</option>
  <option value="TND">TND - Tunisian Dinar</option>
  <option value="TOP">TOP - Pa'anga</option>
  <option value="TRY">TRY - New Turkish Lira</option>
  <option value="TTD">TTD - Trinidad and Tobago Dollar</option>
  <option value="TWD">TWD - New Taiwan Dollar</option>
  <option value="TZS">TZS - Tanzanian Shilling</option>
  <option value="UAH">UAH - Hryvnia</option>
  <option value="UGX">UGX - Uganda Shilling</option>
  <option value="USD">USD - US Dollar</option>
  <option value="UYI">UYI - Uruguay Peso en Unidades Indexadas</option>
  <option value="UYU">UYU - Peso Uruguayo</option>
  <option value="UZS">UZS - Uzbekistan Sum</option>
  <option value="VEF">VEF - Bolivar Fuerte</option>
  <option value="VND">VND - Dong</option>
  <option value="VUV">VUV - Vatu</option>
  <option value="WST">WST - Tala</option>
  <option value="XAF">XAF - CFA Franc BEAC</option>
  <option value="XAG">XAG - Silver</option>
  <option value="XAU">XAU - Gold</option>
  <option value="XCD">XCD - East Caribbean Dollar</option>
  <option value="XDR">XDR - SDR</option>
  <option value="XOF">XOF - CFA Franc BCEAO</option>
  <option value="XPD">XPD - Palladium</option>
  <option value="XPF">XPF - CFP Franc</option>
  <option value="XPT">XPT - Platinum</option>
  <option value="YER">YER - Yemeni Rial</option>
  <option value="ZAR">ZAR - Rand</option>
  <option value="ZMW">ZMW - Zambian Kwacha</option>
  <option value="ZWD">ZWD - Zimbabwe Dollar</option>
  </select>
  </div>

   <!-- IBAN Code Section -->
<div id="iban_code_section" style="display: none;">
  <label for="iban_code">IBAN Code:<span id="iban_code_required_star" style="color: red; display: none;">*</span></label>
  <input type="text" id="iban_code" name="iban_code" oninput="validateIBAN()" />
  <span id="iban_error" style="color: red; font-size: 13px; display: none;">Please ensure IBAN code is correct</span>
</div>

    <!-- cin -->
   <div id= "cin_section" style="display: none;">
  <label>CIN:<span id="cin_required_star" style="color: red; display: none;">*</span></label>
  <select name="cin" id = "cin">
    <option value="">--Select--</option>
   <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
    <option value="D">D</option>
    <option value="E">E</option>
    <option value="F">F</option>
    <option value="G">G</option>
    <option value="H">H</option>
    <option value="I">I</option>
    <option value="J">J</option>
    <option value="K">K</option>
    <option value="L">L</option>
    <option value="M">M</option>
    <option value="N">N</option>
    <option value="O">O</option>
    <option value="P">P</option>
    <option value="Q">Q</option>
    <option value="R">R</option>
    <option value="S">S</option>
    <option value="T">T</option>
    <option value="U">U</option>
    <option value="V">V</option>
    <option value="W">W</option>
    <option value="X">X</option>
    <option value="Y">Y</option>
    <option value="Z">Z</option>
  </select>
  </div>

    <!-- swift code -->
    <div id= "swift_code_section" style="display: none;">
  <label for="swift_code">SWIFT Code:<span id="swift_code_required_star" style="color: red; display: none;">*</span></label>
  <input type="text" id="swift_code" name="swift_code" />
  </div>

  <!-- bank details attachment -->
<div id="bank_detail_attachment_section" style="display: none;">
  <label>
    Bank Details Attachment:
    <span id="bank_details_attachment_required_star" style="color: red; display: none;">*</span>

    <!-- Tooltip -->
    <span class="tooltip">
      <span class="tooltip-icon">i</span>
      <span class="tooltiptext">
        Documenti bancari: dichiarazione rilasciata dalla banca del fornitore che attesti che i dati riportati nel form sono corretti ed identificano il fornitore medesimo; oppure documento equipollente che possa identificare gli stessi (copia di un estratto conto bancario dal quale si evincono i dati riportati).
      </span>
    </span>
  </label>

  <input type="file" id="bank_details_attachment" name="bank_details_attachment"  accept="application/pdf, image/*"  />
</div>

 </fieldset>

  <button type="submit">Submit</button>
</form>

<!-- JavaScript to handle conditional visibility -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const supplierType = document.getElementById('supplier_legal_personality');
    const naturalFields = document.getElementById('natural_person_fields');
    const legalFields = document.getElementById('legal_person_fields');
    const naturalFieldsEnd = document.getElementById('natural_person_fields_end');
    const legalFieldsEnd = document.getElementById('legal_person_fields_end');
    const mediagroupWrapper = document.getElementById('group_wrapper');
    const mediagroupSelector = document.getElementById('group_d365');
    const mediaVehicleSection = document.getElementById('media_vehicle_section');
    const vendorWebsiteSection = document.getElementById('vendor_website_section');
    const vendorWebsiteInput = document.getElementById('vendor_website');
    const websiteStar = document.getElementById('website_required_star');
    const inactiveBcEntity = document.getElementById('inactive_bpc_entity');
    const inactiveBcEntitySection = document.getElementById('inactive_bpc_entity_section');
    const vatGroup = document.getElementById('vat_group');
    const vendorCreatedByDentsu = document.getElementById('vendor_created_by_dentsu');
    const pecSection = document.getElementById('pec_section');
    const supplierVatNumberSection = document.getElementById('supplier_vat_number_section');
    const supplierFiscalCodeSection = document.getElementById('supplier_fiscal_code_section');
    const supplierVatNumberInput = document.getElementById('supplier_vat_number');
    const pecInput = document.getElementById('pec');
    const supplierFiscalCodeInput = document.getElementById('supplier_fiscal_code');
     const mediaVehicleCheckboxes = document.querySelectorAll('input[name="media_vehicle"]');
    const supplierVatNumberStar = document.getElementById('supplier_vat_number_required_star');
    const supplierFiscalCodeStar = document.getElementById('supplier_fiscal_code_required_star');
     const withholdingTaxSection = document.getElementById('witholding_tax_section');
    const withholdingTaxInput = document.getElementById('withholding_tax');
    const withholdingTaxStar = document.getElementById('witholding_tax_required_star');
    const professionalInput = document.getElementById('professional');
    const professionalSection = document.getElementById('professional_section');
    const professionalStar = document.getElementById('professional_required_star');
    const bankNameSection = document.getElementById('bank_name_section');
    const bankNameInput = document.getElementById('bank_name');
    const bankNameStar = document.getElementById('bank_name_required_star');
    const bankAddressSection = document.getElementById('bank_address_section');
    const bankAddressInput = document.getElementById('bank_address');
    const bankAddressStar = document.getElementById('bank_address_required_star');
    const accountHolderSection = document.getElementById('account_holder_section');
    const accountHolderInput = document.getElementById('account_holder');
    const accountHolderStar = document.getElementById('account_holder_required_star');
    const accountNumberSection = document.getElementById('account_number_section');
    const accountNumberInput = document.getElementById('account_number');
    const accountNumberStar = document.getElementById('account_number_required_star');
    const currencySection = document.getElementById('currency_section');
    const currencyInput = document.getElementById('currency');
    const currencyStar = document.getElementById('currency_required_star');
    const ibanCodeSection = document.getElementById('iban_code_section');
    const ibanCodeInput = document.getElementById('iban_code');
    const ibanCodeStar = document.getElementById('iban_code_required_star');
    const cinSection = document.getElementById('cin_section');
    const cinInput = document.getElementById('cin');
    const cinStar = document.getElementById('cin_required_star');
    const swiftCodeSection = document.getElementById('swift_code_section');
    const swiftCodeInput = document.getElementById('swift_code');
    const swiftCodeStar = document.getElementById('swift_code_required_star');
    const bankDetailsAttachmentSection = document.getElementById('bank_detail_attachment_section');
    const bankDetailsAttachmentInput = document.getElementById('bank_details_attachment');
    const bankDetailsAttachmentStar = document.getElementById('bank_details_attachment_required_star');
    const attachmentChambreSection = document.getElementById('attachment_chambre_section');
    const attachmentChambreInput = document.getElementById('attachment_chambre');
    const attachmentChambreStar = document.getElementById('attachment_chambre_required_star');
    const companySection = document.getElementById("company_section");

  function validateAccountNumber() {
  const accountInput = document.getElementById("account_number");
  const accountValue = accountInput.value.trim();
  const accountError = document.getElementById("account_number_error");
  // Don't validate empty optional fields
  if (!accountValue) {
    accountInput.style.borderColor = "";
    accountInput.setCustomValidity("");
    if (accountError) accountError.style.display = "none";
    return true;
  }

  const isValid = /^\d{12}$/.test(accountValue);

  if (!isValid) {
    accountInput.style.borderColor = "red";
    accountInput.setCustomValidity("Invalid account number. Must be exactly 12 digits.");
    if (accountError) accountError.style.display = "inline";
    return false;
  } else {
    accountInput.style.borderColor = "";
    accountInput.setCustomValidity("");
    if (accountError) accountError.style.display = "none";
    return true;
  }
}

function validateVATNumber() {
  const vatInput = document.getElementById("supplier_vat_number");
  const vatValue = vatInput.value.trim();
  const vatError = document.getElementById("vat_error");
  // Don't validate empty optional fields
  if (!vatValue) {
    vatInput.style.borderColor = "";
    vatInput.setCustomValidity("");
    if (vatError) vatError.style.display = "none";
    return true;
  }
  const isValid = /^\d{11}$/.test(vatValue);

  if (!isValid) {
    vatInput.style.borderColor = "red";
    vatInput.setCustomValidity("Invalid VAT number. Must be exactly 11 digits.");
    if (vatError) vatError.style.display = "inline";
    return false;
  } else {
    vatInput.style.borderColor = "";
    vatInput.setCustomValidity("");
    if (vatError) vatError.style.display = "none";
    return true;
  }
}

function validateIBAN() {
  const ibanInput = ibanCodeInput;
  const errorMsg = document.getElementById("iban_error");
  const ibanValue = ibanInput.value.trim();
  // Don't validate empty optional fields
  if (!ibanValue) {
    ibanInput.style.borderColor = "";
    ibanInput.setCustomValidity("");
    errorMsg.style.display = "none";
    return true;
  }

  const isValid = /^[A-Za-z0-9]{27}$/.test(ibanValue);

  if (!isValid) {
    errorMsg.style.display = "block";
    ibanInput.style.borderColor = "red";
    ibanInput.setCustomValidity("Invalid IBAN number. Must be exactly 27 digits.");
    return false;
  } else {
    errorMsg.style.display = "none";
    ibanInput.setCustomValidity("");
    ibanInput.style.borderColor = "";
    return true;
  }
}

function validateEmail(event) {
  const emailInput = event.target;
  const email = emailInput.value.trim();
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  const errorSpan = document.getElementById(`${emailInput.id}_error`);
  // Don't validate empty optional fields
  if (!email) {
    emailInput.style.borderColor = "";
    emailInput.setCustomValidity("");
    if (errorSpan) errorSpan.style.display = 'none';
    return true;
  }
  const isValid = email === '' || emailRegex.test(email); // Allow empty or valid

  if (!isValid) {
    emailInput.style.borderColor = 'red';
    emailInput.setCustomValidity('Invalid email address.');
    if (errorSpan) errorSpan.style.display = 'inline';
    return false;
  } else {
    emailInput.style.borderColor = '';
    emailInput.setCustomValidity('');
    if (errorSpan) errorSpan.style.display = 'none';
    return true;
  }
}
function shouldValidate(el) {
  return el && el.required;
}

   function toggleBasedOnProfessional() {
  const supplier = supplierType.value;
  const vendorCreated = vendorCreatedByDentsu.value;
  const professional = professionalInput.value;

  // Always show professional and withholding tax section
  professionalSection.style.display = 'block';
  withholdingTaxSection.style.display = 'block';

  if (supplier === 'Natural Person') {
    if (vendorCreated === 'Yes') {
      professionalInput.required = true;
      professionalStar.style.display = 'inline';
      document.getElementById('attachment_fiscal_code').required = false;
      document.getElementById('attachment_identity_card').required = false;
      document.getElementById('attachment_fiscal_code_star').style.display = 'none';
      document.getElementById('attachment_identity_card_star').style.display = 'none';

      if (professional === 'Yes') {
        withholdingTaxInput.required = true;
        withholdingTaxStar.style.display = 'inline';
      } else if (professional === 'No') {
        withholdingTaxInput.required = false;
        withholdingTaxStar.style.display = 'none';
      } else {
        // if no professional selected yet
        withholdingTaxInput.required = false;
        withholdingTaxStar.style.display = 'none';
      }

    } else {
      // Dentsu == No
      document.getElementById('attachment_fiscal_code').required = true;
      document.getElementById('attachment_identity_card').required = true;
      document.getElementById('attachment_fiscal_code_star').style.display = 'inline';
      document.getElementById('attachment_identity_card_star').style.display = 'inline';
      professionalInput.required = true;
      professionalStar.style.display = 'inline';
      if (professional === 'Yes') {
        withholdingTaxInput.required = true;
        withholdingTaxStar.style.display = 'inline';
      } else if (professional === 'No') {
        withholdingTaxInput.required = false;
        withholdingTaxStar.style.display = 'none';
      } else {
        // if no professional selected yet
        withholdingTaxInput.required = false;
        withholdingTaxStar.style.display = 'none';
      }
    }
  } else {
    // Legal Person
    professionalInput.required = false;
    withholdingTaxInput.required = false;
    withholdingTaxStar.style.display = 'none';
    professionalStar.style.display = 'none';
  }
}
    function toggleSupplierFields() {
  const supplier = supplierType.value;

  // Toggle display of major sections
  naturalFields.style.display = supplier === 'Natural Person' ? 'block' : 'none';
  legalFields.style.display = supplier === 'Legal Person' ? 'block' : 'none';
  naturalFieldsEnd.style.display = supplier === 'Natural Person' ? 'block' : 'none';
  legalFieldsEnd.style.display = supplier === 'Legal Person' ? 'block' : 'none';

  // Reset optional sections
  mediagroupSelector.value = 'none';
  mediaVehicleSection.style.display = 'none';
  vendorWebsiteSection.style.display = 'none';
  vendorWebsiteInput.required = false;
  websiteStar.style.display = 'none';
  inactiveBcEntitySection.style.display = 'none';
  pecSection.style.display = 'none';
  pecInput.required = false;
  supplierVatNumberSection.style.display = 'none';
  supplierVatNumberInput.required = false;
  supplierFiscalCodeSection.style.display = 'none';
  supplierFiscalCodeInput.required = false;
  supplierFiscalCodeStar.style.display = 'none';

  // Get all inputs in each section
  const naturalInputs = naturalFields.querySelectorAll('input, select, textarea');
  const naturalEndInputs = naturalFieldsEnd.querySelectorAll('input, select, textarea');
  const legalInputs = legalFields.querySelectorAll('input, select, textarea');
  const legalEndInputs = legalFieldsEnd.querySelectorAll('input, select, textarea');

  // Set required only for visible section
  if (supplier === 'Legal Person') {
    legalInputs.forEach(input => input.required = true);
    legalEndInputs.forEach(input => input.required = false);
    naturalInputs.forEach(input => input.required = false);
    naturalEndInputs.forEach(input => input.required = false);
    document.getElementById('payment_term_days').required = true;
    document.getElementById('request_by').required = true;
    document.getElementById('supplier_legal_personality').required = true;
    document.getElementById('vendor_created_by_dentsu').required = true;
    document.getElementById('group_d365').required = true;
    document.getElementById('influencer_d365').required = true;
    document.getElementById('supplier_company_name').required = true;
    document.getElementById('address').required = true;
    document.getElementById('n').required = true;
    document.getElementById('postal_code').required = true;
    document.getElementById('country').required = true;
    document.getElementById('city').required = true;
    document.getElementById('telephone_number').required = true;
    document.getElementById('vat_group').required = true;
    document.getElementById('dentsu_contact_email').required = true;
    document.getElementById('vendor_email').required = true;
    document.getElementById('payment_method').required = true;
  } else if (supplier === 'Natural Person') {
    naturalInputs.forEach(input => input.required = true);
    naturalEndInputs.forEach(input => input.required = false);
    legalInputs.forEach(input => input.required = false);
    legalEndInputs.forEach(input => input.required = false);
    document.getElementById('payment_term_days').required = true;
    document.getElementById('request_by').required = true;
    document.getElementById('supplier_legal_personality').required = true;
    document.getElementById('vendor_created_by_dentsu').required = true;
    document.getElementById('group_d365').required = true;
    document.getElementById('influencer_d365').required = true;
    document.getElementById('first_name').required = true;
    document.getElementById('last_name').required = true;
    document.getElementById('birth_place').required = true;
    document.getElementById('birth_county').required = true;
    document.getElementById('birth_date').required = true;
    document.getElementById('gender').required = true;
    document.getElementById('address').required = true;
    document.getElementById('n').required = true;
    document.getElementById('postal_code').required = true;
    document.getElementById('country').required = true;
    document.getElementById('city').required = true;
    document.getElementById('telephone_number').required = true;
    document.getElementById('vat_group').required = true;
    document.getElementById('dentsu_contact_email').required = true;
    document.getElementById('vendor_email').required = true;
    document.getElementById('payment_method').required = true;
  }
}

    function toogleBasedOnAttachmentChambre(){
      if(vendorCreatedByDentsu.value === 'Yes') {
        attachmentChambreSection.style.display = 'block';
        attachmentChambreInput.required = false;
        attachmentChambreStar.style.display = 'none';
      } else if (vendorCreatedByDentsu.value === 'No' && supplierType.value === 'Legal Person') {
        attachmentChambreSection.style.display = 'block';
        attachmentChambreInput.required = true;
        attachmentChambreStar.style.display = 'inline';
      } else {
        attachmentChambreSection.style.display = 'block';
        attachmentChambreInput.required = false;
        attachmentChambreStar.style.display = 'none';
      }
    }
    function toggleForStateAndCounty(){
      if(document.getElementById('country').value === 'ITA - Italy') {
        state_and_county.style.display = 'block';
        county.required = true;
        state.required = true;
      }else {
        state_and_county.style.display = 'none';
        county.required = false;
        state.required = flase;
      }
    }
    function toggleBasedOnVendorCreatedByDentsu() {
      if (vendorCreatedByDentsu.value === 'Yes'){
        bankNameSection.style.display = 'block';
        bankNameInput.required = false;
        bankNameStar.style.display = 'none';
        bankAddressSection.style.display = 'block';
        bankAddressInput.required = false;
        bankAddressStar.style.display = 'none';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = false;
        accountHolderStar.style.display = 'none';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = false;
        accountHolderStar.style.display = 'none';
        accountNumberSection.style.display = 'block';
        accountNumberInput.required = false;
        accountNumberStar.style.display = 'none';
        currencySection.style.display = 'block';
        currencyInput.required = false;
        currencyStar.style.display = 'none';
        ibanCodeSection.style.display = 'block';
        ibanCodeInput.required = false;
        ibanCodeStar.style.display = 'none';
        cinSection.style.display = 'block';
        cinInput.required = false;
        cinStar.style.display = 'none';
        swiftCodeSection.style.display = 'block';
        swiftCodeInput.required = false;
        swiftCodeStar.style.display = 'none';
        bankDetailsAttachmentSection.style.display = 'block';
        bankDetailsAttachmentInput.required = false;
        bankDetailsAttachmentStar.style.display = 'none';
      } else if (vendorCreatedByDentsu.value === 'No' && vatGroup.value === 'FOR_ITA'){
        bankNameSection.style.display = 'block';
        bankNameInput.required = true;
        bankNameStar.style.display = 'inline';
        bankAddressSection.style.display = 'block';
        bankAddressInput.required = true;
        bankAddressStar.style.display = 'inline';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = true;
        accountHolderStar.style.display = 'inline';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = true;
        accountHolderStar.style.display = 'inline';
        accountNumberSection.style.display = 'block';
        accountNumberInput.required = true;
        accountNumberStar.style.display = 'inline';
        currencySection.style.display = 'block';
        currencyInput.required = true;
        currencyStar.style.display = 'inline';
        ibanCodeSection.style.display = 'block';
        ibanCodeInput.required = true;
        ibanCodeStar.style.display = 'inline';
        cinSection.style.display = 'block';
        cinInput.required = true;
        cinStar.style.display = 'inline';
        swiftCodeSection.style.display = 'block';
        swiftCodeInput.required = false;
        swiftCodeStar.style.display = 'none';
        bankDetailsAttachmentSection.style.display = 'block';
        bankDetailsAttachmentInput.required = true;
        bankDetailsAttachmentStar.style.display = 'inline';
      } else {
        bankNameSection.style.display = 'block';
        bankNameInput.required = true;
        bankNameStar.style.display = 'inline';
        bankAddressSection.style.display = 'block';
        bankAddressInput.required = true;
        bankAddressStar.style.display = 'inline';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = true;
        accountHolderStar.style.display = 'inline';
        accountHolderSection.style.display = 'block';
        accountHolderInput.required = true;
        accountHolderStar.style.display = 'inline';
        accountNumberSection.style.display = 'block';
        accountNumberInput.required = true;
        accountNumberStar.style.display = 'inline';
        currencySection.style.display = 'block';
        currencyInput.required = true;
        currencyStar.style.display = 'inline';
        ibanCodeSection.style.display = 'block';
        ibanCodeInput.required = true;
        ibanCodeStar.style.display = 'inline';
        cinSection.style.display = 'block';
        cinInput.required = true;
        cinStar.style.display = 'inline';
        swiftCodeSection.style.display = 'block';
        swiftCodeInput.required = true;
        swiftCodeStar.style.display = 'inline';
        bankDetailsAttachmentSection.style.display = 'block';
        bankDetailsAttachmentInput.required = true;
        bankDetailsAttachmentStar.style.display = 'inline';
      }
    }
    function toggleBasedOnVatGroup() {
  const supplierTypeValue = supplierType.value; // 'Natural Person' or 'Legal Person'
  const grp = vatGroup.value;

  // Hide and reset all fields
  pecSection.style.display = 'none';
  pecInput.required = false;

  supplierVatNumberSection.style.display = 'none';
  supplierVatNumberInput.required = false;
  supplierVatNumberStar.style.display = 'none';

  supplierFiscalCodeSection.style.display = 'none';
  supplierFiscalCodeInput.required = false;
  supplierFiscalCodeStar.style.display = 'none';

  if (grp === 'FOR_ITA') {
    // Show PEC for both types, never required
    pecSection.style.display = 'block';
    pecInput.required = false;

    if (supplierTypeValue === 'Natural Person') {
      supplierVatNumberSection.style.display = 'block';
      supplierVatNumberInput.required = false;
      supplierVatNumberStar.style.display = 'none';

      supplierFiscalCodeSection.style.display = 'block';
      supplierFiscalCodeInput.required = true;
      supplierFiscalCodeStar.style.display = 'inline';

    } else if (supplierTypeValue === 'Legal Person') {
      supplierVatNumberSection.style.display = 'block';
      supplierVatNumberInput.required = true;
      supplierVatNumberStar.style.display = 'inline';

      supplierFiscalCodeSection.style.display = 'block';
      supplierFiscalCodeInput.required = true;
      supplierFiscalCodeStar.style.display = 'inline';
    }

  } else if (grp === 'FOR_UE') {
    // PEC is hidden for both types
    if (supplierTypeValue === 'Natural Person') {
      supplierVatNumberSection.style.display = 'block';
      supplierVatNumberInput.required = false;
      supplierVatNumberStar.style.display = 'none';

      supplierFiscalCodeSection.style.display = 'block';
      supplierFiscalCodeInput.required = false;
      supplierFiscalCodeStar.style.display = 'none';

    } else if (supplierTypeValue === 'Legal Person') {
      supplierVatNumberSection.style.display = 'block';
      supplierVatNumberInput.required = true;
      supplierVatNumberStar.style.display = 'inline';

      supplierFiscalCodeSection.style.display = 'block';
      supplierFiscalCodeInput.required = false;
      supplierFiscalCodeStar.style.display = 'none';
    }

  } else if (grp === 'FOR_XUE') {
    // For both types, nothing shown
    // All fields stay hidden and not required
  }
}
    function toggleBasedOnMediaGroup() {
  const grp = mediagroupSelector.value;

  mediaVehicleSection.style.display = 'none';
  vendorWebsiteSection.style.display = 'none';
  vendorWebsiteInput.required = false;
  websiteStar.style.display = 'none';
  inactiveBcEntitySection.style.display = 'none';

  if (grp === 'MEDIA') {
    mediaVehicleSection.style.display = 'block';
    vendorWebsiteSection.style.display = 'block';
    vendorWebsiteInput.required = true;
    websiteStar.style.display = 'inline';
  } else if (['NONMEDIA','HOUSE','TAXSS'].includes(grp)) {
    vendorWebsiteSection.style.display = 'block';
    vendorWebsiteInput.required = false;
    websiteStar.style.display = 'none';
  }
      else if (['INTCO'].includes(grp)) {
    vendorWebsiteSection.style.display = 'block';
    vendorWebsiteInput.required = false;
    websiteStar.style.display = 'none';
    inactiveBcEntitySection.style.display = 'block';
  }
}


    supplierType.addEventListener('change', toggleSupplierFields);
    mediagroupSelector.addEventListener('change', toggleBasedOnMediaGroup);
    vendorCreatedByDentsu.addEventListener('change', toggleBasedOnVendorCreatedByDentsu);
    vendorCreatedByDentsu.addEventListener('change', toogleBasedOnAttachmentChambre);
    supplierType.addEventListener('change', toogleBasedOnAttachmentChambre);
    vendorCreatedByDentsu.addEventListener('change', toggleBasedOnVatGroup);
    vatGroup.addEventListener('change' , toggleBasedOnVatGroup);
    vatGroup.addEventListener('change' , toggleBasedOnVendorCreatedByDentsu);
    document.getElementById('country').addEventListener('change' , toggleForStateAndCounty);
    ibanCodeInput.addEventListener('input', validateIBAN);
    pecInput.addEventListener('input', validateEmail);
    document.getElementById('dentsu_contact_email').addEventListener('input', validateEmail);
    document.getElementById('vendor_email').addEventListener('input', validateEmail);
    supplierType.addEventListener('change', toggleBasedOnVatGroup);
    supplierType.addEventListener('change', toggleBasedOnProfessional);
    vendorCreatedByDentsu.addEventListener('change', toggleBasedOnProfessional);
    professionalInput.addEventListener('change', toggleBasedOnProfessional);
    supplierVatNumberInput.addEventListener('input', validateVATNumber);
    accountNumberInput.addEventListener("input", validateAccountNumber);



    // Initial load
    toggleSupplierFields();
    toggleBasedOnProfessional();
    toggleBasedOnMediaGroup();
    toggleBasedOnProfessional();
    toggleBasedOnVendorCreatedByDentsu();
    toogleBasedOnAttachmentChambre();
    toggleBasedOnVatGroup();
    toggleForStateAndCounty();
  });

document.querySelector('form').addEventListener('submit', function (e) {
  const selectedCompanies = document.querySelectorAll('input[name="company"]:checked');
  if (selectedCompanies.length === 0) {
    alert("Please select at least one Company.");
    e.preventDefault();
    return false;
  }
  const selectedMediaVehicles = document.querySelectorAll('input[name="media_vehicle"]:checked');
  if (selectedMediaVehicles.length === 0 && mediagroupSelector.value === 'MEDIA') {
    alert("Please select at least one Media Vehicle.");
    e.preventDefault();
    return false;
  }
  const isAccountValid = validateAccountNumber();
  const isVATValid = validateVATNumber();
  const isIBANValid = validateIBAN();
  const isEmail1Valid = validateEmailById("dentsu_contact_email");
  const isEmail2Valid = validateEmailById("vendor_email");

  // If any is false, prevent submission
  if (!isAccountValid || !isVATValid || !isIBANValid || !isEmail1Valid || !isEmail2Valid) {
    e.preventDefault();
    alert("Please correct the errors in the form before submitting.");
  }
});

</script>
</body>
</html>
